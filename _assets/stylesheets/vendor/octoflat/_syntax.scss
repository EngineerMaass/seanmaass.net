.highlight, html .gist .gist-file .gist-syntax .gist-highlight {
   table td.code {
       width: 100%;
   }
   @include border-bottom-radius(9px);
}

.highlight:first-child, html .gist .gist-file .gist-syntax .gist-highlight {
   @include border-top-radius(9px);
}

.highlight .line-numbers, html .gist .gist-file .gist-syntax .highlight .line_numbers {
   text-align: right;
   font-size: 13px;
   word-break: normal;
   background: $code-bg-color !important;
   @include box-shadow(lighten(#34495e, 2) -1px 0 inset);
   span {
       color: inherit !important;
   }
   padding: .6em !important;
}

figure.code, .gist-file, pre {}

.gist .highlight, figure.code .highlight {
   @include selection(adjust-color($code-bg-color, $lightness: 23%, $saturation: -65%), $text_shadow: $code-color 0 1px);
}

html .gist .gist-file {
   position: relative;
   border: none;
   //padding-top: image-height(asset_path('code_bg.png')) !important;
   padding-top: 26px;
   .highlight {
       margin-bottom: 0;
   }
   .gist-syntax {
       border-bottom: 0 !important;
       background: none !important;
       .gist-highlight {
           background: $code-bg-color !important;
       }
       .highlight pre {
           @extend .pre-code;
           padding: 0;
       }
   }
   .gist-meta {
       padding: .6em 0.8em;
       border: 1px solid lighten($code-bg-color, 2) !important;
       color: $code-color;
       font-size: .7em !important;
       background: $code-bg-color $noise-bg;
       @extend .sans !optional;
       a {
           color: mix($code-color, $code-hl-comment) !important;
           @include hover-link;
           &:hover {
               color: $code-color !important;
           }
       }
       a[href*='#file'] {
           position: absolute;
           top: 0;
           left: 0;
           right: -10px;
           color: #474747 !important;
           @extend .code-title;
           &:hover {
               color: $link-color !important;
           }
       }
       a[href*=raw] {
           @extend .download-source;
           top: .4em;
       }
   }
}

pre {
   @include border-radius(0.4em);
   @extend .mono;
   font-size: 13px;
   margin-bottom: 2.1em;
   padding: .8em 1em;
   color: $code-color;
   overflow: auto;
   background-color: $code-bg-color;
   border: 1px solid $code-bg-color;
}

h3.filename {
   @extend .code-title;
   + pre {
       @include border-top-radius(0px);
   }
}

p, li {
   code {
       @extend .mono;
       display: inline-block;
       white-space: no-wrap;
       background: $code-inline-bg-color !important;
       font-size: .8em;
       color: $code-color !important;
       border: none;
       @include border-radius(0.4em);
       padding: 0 .3em;
       margin: -1px 0;
   }
   pre code {
       font-size: 1em !important;
       background: none;
       border: none;
   }
}

/*
*         CSS Class Key
*
* Comments
* - Comment                       .c
* - Multiline comment             .cm
* - Single-line comment           .cs
* - Preprocessor comment          .cp
* - Special commnet               .cs
*
* Errors
* - Error                         .err
*
* Keywords
* - Keyword                       .k
*
* Operators
* - Operator                      .o
* - Word                          .ow
*
* Generic
* - Deleted                       .gd
* - Deleted specific              .gd .x
* - Emphasis                      .ge
* - Error                         .gr
* - Heading                       .gh
* - Inserted                      .gi
* - Inserted specific             .gi .x
* - Output                        .go
* - Prompt                        .gp
* - Strong                        .gs
* - Subheading                    .gu
* - Traceback                     .gt
*
* Keywords
* - Constant                      .kc
* - Declaration                   .kd
* - Pseudo                        .kp
* - Reserved                      .kr
* - Type                          .kt
*
* Names
* - Name                          .n
* - Attribute                     .na
* - Builtin                       .nb
* - Class                         .nc
* - Constant                      .no
* - Entity                        .ni
* - Exception                     .nl
* - Function                      .nf
* - Namespace                     .nn
* - Tag                           .nt
* - Builtin pseudo                .nx
*
* Variables
* - Class                         .vc
* - Global                        .vg
* - Instance                      .vi
* - Variable                      .nv
*
* Text
* - Parenthesis                   .p
* - Whitespace                    .w
*
* Literals
* - Number                        .m
* - Number Float                  .mf
* - Number Integer                .mi
* - Number Integer Long           .il
* - Number Hex                    .mh
* - Number Oct                    .mo
* - String                        .s
* - String Backstick              .sb
* - String Char                   .sc
* - String Doc                    .sd
* - String Double                 .s2
* - String Escape                 .se
* - String Heredoc                .sh
* - String Interpol               .si
* - String Other                  .sx
* - String Regex                  .sr
* - String Single                 .s1
* - String Symbol                 .ss
*/
.pre-code {
   font-family: $mono !important;
   overflow: scroll;
   overflow-y: hidden;
   display: block;
   padding: .6em;
   overflow-x: auto;
   white-space: pre;
   background: $code-bg-color !important;
   color: $code-color !important;
   span {
       color: $code-color !important;
       font-style: normal !important;
       font-weight: normal !important;
   }
   .c, .cm, .cp, .c1, .cs {
       color: $code-hl-comment !important;
       font-style: italic !important;
       .cs {
           font-weight: bold !important;
       }
   }
   .err {
       color: $code-hl-invalid !important;
       background-color: $code-bg-color !important;
   }
   .k {
       color: $code-hl-keyword !important;
   }
   .o {
       color: $code-hl-keyword !important;
       font-weight: bold !important;
   }
   .p {
       color: $code-color !important;
   }
   .ow {
       color: $code-hl-keyword !important;
       font-weight: bold !important;
   }
   .gd {
       color: $code-hl-keyword !important;
       display: inline-block;
       background-color: mix($code-bg-color, $code-hl-invalid, 25%) !important;
   }
   .gd .x {
       color: $code-hl-keyword !important;
       background-color: mix($code-bg-color, $code-hl-invalid, 35%) !important;
       display: inline-block;
   }
   .ge {
       color: $code-hl-keyword !important;
       font-style: italic !important;
   }
   .gr {
       color: $code-hl-invalid !important;
   }
   .gh {
       color: $code-color !important;
   }
   .gi {
       color: $code-color !important;
       background-color: mix($code-bg-color, $code-hl-invalid, 20%) !important;
       display: inline-block;
   }
   .gi .x {
       color: $code-color !important;
       background-color: mix($code-bg-color, $code-hl-invalid, 40%) !important;
       display: inline-block;
   }
   .go {
       color: $code-color !important;
   }
   .gp {
       color: $code-hl-keyword !important;
       font-weight: bold !important;
   }
   .gs {
       color: $code-color !important;
       font-weight: bold !important;
   }
   .gu {
       color: $code-color !important;
   }
   .kc {
       color: $code-hl-constant !important;
       font-weight: bold !important;
   }
   .kd {
       color: $code-hl-storage-type !important;
   }
   .kp {
       color: $code-hl-storage-type !important;
       font-weight: bold !important;
   }
   .kr {
       color: $code-hl-keyword !important;
       font-weight: bold !important;
   }
   .kt {
       color: $code-hl-storage-type !important;
   }
   .n {
       color: $code-hl-variable !important;
   }
   .na {
       color: $code-hl-variable !important;
   }
   .nb {
       color: $code-hl-library-func !important;
   }
   .nc {
       color: $code-hl-class !important;
   }
   .no {
       color: $code-hl-constant !important;
   }
   .ni {
       color: $code-color !important;
   }
   .nl {
       color: $code-hl-invalid !important;
   }
   .ne {
       color: $code-hl-tag !important;
       font-weight: bold !important;
   }
   .nf {
       color: $code-hl-function !important;
       font-weight: bold !important;
   }
   .nn {
       color: $code-hl-class !important;
   }
   .nt {
       color: $code-hl-tag !important;
       font-weight: bold !important;
   }
   .nx {
       color: $code-hl-builtin !important;
   }
   .bp {
       color: $code-hl-builtin !important;
   }
   .vc {
       color: $code-hl-class !important;
   }
   .vg {
       color: $code-hl-constant !important;
   }
   .vi {
       color: $code-hl-variable !important;
   }
   .nv {
       color: $code-hl-variable !important;
   }
   .w {
       color: $code-color !important;
   }
   .mf {
       color: $code-hl-number !important;
   }
   .m {
       color: $code-hl-number !important;
   }
   .mh {
       color: $code-hl-number !important;
   }
   .mi {
       color: $code-hl-number !important;
   }
   .mo {
       color: $code-hl-number !important;
   }
   .s {
       color: $code-hl-string !important;
   }
   .sb {
       color: $code-hl-string !important;
   }
   .sc {
       color: $code-hl-string !important;
   }
   .sd {
       color: $code-hl-string !important;
   }
   .s2 {
       color: $code-hl-string !important;
   }
   .se {
       color: $code-hl-string !important;
   }
   .se {
       color: $code-hl-string !important;
   }
   .si {
       color: $code-hl-number !important;
   }
   .sx {
       color: $code-hl-string !important;
   }
   .sr {
       color: $code-hl-string !important;
   }
   .s1 {
       color: $code-hl-string !important;
   }
   .ss {
       color: $code-hl-string !important;
   }
   .il {
       color: $code-hl-number !important;
   }
   div {
       .gd, .gd .x, .gi, .gi .x {
           display: inline-block;
           width: 100%;
       }
   }
}

.highlight, .gist-highlight {
   pre {
       background: none;
       @include border-radius(0px);
       border: none;
       padding: 0;
       margin-bottom: 0;
   }
   margin-bottom: 1.8em;
   background: $code-bg-color;
   overflow-y: hidden;
   overflow-x: auto;
}

$code-scroll-bg: rgba(white, 0.15);
$code-scroll-thumb: rgba(white, 0.2);

pre, .highlight, .gist-highlight {
   &::-webkit-scrollbar {
       height: .5em;
       background: $code-scroll-bg;
   }
   &::-webkit-scrollbar-thumb:horizontal {
       background: $code-scroll-thumb;
       -webkit-border-radius: 4px;
       border-radius: 4px;
   }
}

.highlight code {
   @extend .pre-code;
   background: #000;
}

figure.code {
   background: none;
   padding: 0;
   border: 0;
   margin-bottom: 1.5em;
   pre {
       margin-bottom: 0;
   }
   figcaption {
       position: relative;
       @extend .code-title;
       a {
           @extend .download-source;
       }
   }
   .highlight {
       margin-bottom: 0;
   }
}

.code-title {
   text-align: center;
   font-size: 13px;
   text-shadow: #cbcccc 0 1px 0;
   color: #474747;
   font-weight: normal;
   margin-bottom: 0;
   @include border-top-radius(9px);
   font-family: "Helvetica Neue", Arial, "Lucida Grande", "Lucida Sans Unicode", Lucida, sans-serif;
   background: #aaaaaa url(asset_path("code_bg.png")) top repeat-x;
}

.download-source {
   position: absolute;
   right: .8em;
   @include hover-link;
   color: #666 !important;
   z-index: 1;
   font-size: 13px;
   text-shadow: #cbcccc 0 1px 0;
   padding-left: 3em;
}

.code {
   -webkit-margin-start: 0px;
   -webkit-margin-end: 0px;
}
